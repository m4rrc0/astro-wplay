---
import { SkeletonPage, BasicPage } from '@layouts'
import { IO, ImgDirectus } from '@components'

const { lang, articles: as } = Astro.props || {}

const articles = [...as, ...as, ...as, ...as, ...as]

---
<SkeletonPage lang={lang.code}>
  <BasicPage {lang}>
    <main class="center max">
        <div class="box no-border stack gap-down-h1">
            <h1 class="center text">Articles</h1>
            <div class="grid gap-down-h4" style="--width-column: var(--width-col-4);">
                <div>
                    {articles.map(a => {
                        const headerT = a?.header?.[0].translations.find(({ languages_code }) => languages_code === lang.code )
                        return (
                            <article
                                class="card-article
                                    breakout-clickable
                                    box no-border stack gap-down-h2 split-after-2
                                    color-palette-variation-contrast
                                    border-radius-m"
                                >
                                <IO div $skipNoInner style="width: fit-content;">
                                    <ImgDirectus
                                        $skip={!headerT?.featured_image?.src}
                                        src={headerT?.featured_image?.src}
                                        alt={headerT?.title}
                                        loading="lazy"
                                        class="featured-image"
                                        width="590"
                                        height="400"
                                        fit="cover"
                                        quality="90" />
                                </IO>
                                <h2 class="h3">
                                    <a href={`/${a.path}`} class="reset clickable">{headerT?.title}</a>
                                </h2>
                                <IO div $skipNoInner class="stack gap-down-h7">
                                    <IO div $skipNoInner class="cluster">
                                        <IO ul $skipNoInner class="reset">
                                            {a?.authors?.map(author => (
                                                <IO li $skipNoInner class="stack horizontal gap-down-h7">
                                                    <IO div $skip={!author?.avatar?.src} class="box no-padding border-radius-circle border-width-1">
                                                        <ImgDirectus
                                                            $skip={!author?.avatar?.src}
                                                            src={author?.avatar?.src}
                                                            alt={author?.display_name}
                                                            loading="lazy"
                                                            class="border-radius-circle"
                                                            style="max-width: 32px; max-height: 32px; width: 100%; height: 100%;"
                                                            width="32"
                                                            height="32"
                                                            fit="cover"
                                                            quality="90" />
                                                    </IO>
                                                    <IO p $skipNoInner class="author-name">{author?.display_name}</IO>
                                                </IO>
                                            ))}
                                        </IO>
                                    </IO>
                                    <hr />
                                    <IO p $skip={!a?.date_published?.fr?.date}>Publi√© le <strong>{a?.date_published?.fr?.date}</strong></IO>
                                </IO>
                            </article>
                        )
                    })}
                </div>
            </div>
        </div>
    </main>
  </BasicPage>
</SkeletonPage>

