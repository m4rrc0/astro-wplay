---
import { IO, Img, ImgDirectus, SEO } from "@components";
import placeholderWPlayCircleBlue from "@images/WannaPlay-button-circle-blue.png";
import { BasicPage, SkeletonPage } from "@layouts";

const { lang, organizations } = Astro.props

const availableOrganizations = organizations?.filter(
  (organization) => organization.boardgame_related
);

const canonicalURL = new URL(Astro.url.pathname, Astro.site)

---

<SkeletonPage lang={lang.code}>
  <SEO
    slot="head"
    ogType="website"
    title={`Soirées jeux, clubs, bar à jeux, ludothèques dans la province de `}
    description={`Tu veux jouer dans la province de ? Viens découvrir les lieux ludiques de la région.`}
    canonicalUrl={canonicalURL.href}
    socialImage="/assets/images/LOGO-1024px.png"
    ogVideo={false}
    twitterCard="summary"
  />
  <BasicPage {lang}>
    <main class="center width-max">
      <div id="events-list-container" class="box no-border stack gap-down-h1">
        <IO h2 $skip={!availableOrganizations?.[0]} class="center text">
          Organisations
        </IO>
        <IO
          div
          $skipNoInner
          class="grid gap-down-h4"
          style="--width-column: var(--width-col-6);"
        >
          <IO ul $skipNoInner class="reset">
            {
              availableOrganizations?.map((organization) => {
                const { name, path, logo, typesTranslated } = organization

                const nameIsLong = name.length > 30

                return (
                  <li
                    class="card-organization
                                        box no-border stack gap-down-h7 split-after-1
                                        border-radius-s
                                        breakout-clickable"
                    style=""
                  >
                    <div
                      class="center intrinsic"
                      style="justify-content: center; height: var(--width-col-10); overflow: hidden;"
                    >
                      {logo?.src ? (
                        <ImgDirectus
                          image={logo}
                          src={logo?.src}
                          alt={name}
                          loading="lazy"
                          class=""
                          style="width: 120px; max-width: 100%; height: auto; max-height: 120px;"
                          width="120"
                          height="120"
                          fit="inside"
                          quality="99"
                        />
                      ) : (
                        <Img
                          src={placeholderWPlayCircleBlue}
                          alt="logo"
                          loading="lazy"
                          class=""
                          style="width: 120px; max-width: 100%; height: auto; max-height: 120px;"
                          width="120"
                          height="120"
                        />
                      )}
                    </div>
                    <h3>
                      <a
                        href={`/${path}`}
                        class={`reset clickable${nameIsLong ? " h4" : ""}`}
                      >
                        {name}
                      </a>
                    </h3>
                    <IO
                      div
                      $skip={!typesTranslated?.[0]}
                      class="cluster gap-down-h8"
                    >
                      <ul class="reset">
                        {typesTranslated?.map((type) => {
                          const currentPalette = `color-palette-${type.code_name}`
                          return (
                            <li
                              class={`box no-border padding-x-h8 padding-y-h9
                                                            ${currentPalette} color-palette-variation-contrast
                                                            border-radius-s`}
                            >
                              {type.fr}
                            </li>
                          )
                        })}
                      </ul>
                    </IO>
                  </li>
                )
              })
            }
          </IO>
        </IO>
      </div>
    </main>
  </BasicPage>
</SkeletonPage>

<style>
  .sort.asc::after {
    content: "\002B06";
    padding-left: 3px;
  }
  .sort.desc::after {
    content: "\002B07";
    padding-left: 3px;
  }
</style>
